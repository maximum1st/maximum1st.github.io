<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>レーシングサスペンション計算</title>
    <style>
        .form-container {
            display: flex;
            flex-direction: column;
            max-width: 250px;
            margin: left;
        }
        input, select, button {
            max-width: 100%;
        }
    </style>
    <script>
        function calculateSuspension() {
            const engineWeight = getEngineWeight();
            const customEngineWeight = parseFloat(document.getElementById("customEngineWeight").value);
            const totalWeight = parseFloat(document.getElementById("totalWeight").value);
            const weightRatio = parseFloat(document.getElementById("weightRatio").value) / 100;
            const frontWeight = totalWeight * weightRatio;
            const rearWeight = totalWeight * (1 - weightRatio);
            const frontSpringFreq = parseFloat(document.getElementById("frontSpringFreq").value);
            const rearSpringFreq = parseFloat(document.getElementById("rearSpringFreq").value);
            const frontCurrentHeight = parseFloat(document.getElementById("frontCurrentHeight").value);
            const rearCurrentHeight = parseFloat(document.getElementById("rearCurrentHeight").value);
            const frontMinHeight = parseFloat(document.getElementById("frontMinHeight").value);
            const frontMaxHeight = parseFloat(document.getElementById("frontMaxHeight").value);
            const rearMinHeight = parseFloat(document.getElementById("rearMinHeight").value);
            const rearMaxHeight = parseFloat(document.getElementById("rearMaxHeight").value);

            const nurburgringFactor = 0.8;
            const tsukubaFactor = 0.9;

            const frontSpringRate = (Math.pow((frontSpringFreq * 2 * Math.PI), 2)) * (frontWeight + engineWeight + customEngineWeight);
            const rearSpringRate = (Math.pow((rearSpringFreq * 2 * Math.PI), 2)) * (rearWeight + engineWeight + customEngineWeight);

            const frontSpringFreqFromRate = Math.sqrt(frontSpringRate / (frontWeight + engineWeight + customEngineWeight)) / (2 * Math.PI);
            const rearSpringFreqFromRate = Math.sqrt(rearSpringRate / (rearWeight + engineWeight + customEngineWeight)) / (2 * Math.PI);

            const optimalFreqNurburgring = calculateOptimalFreqNurburgring(frontSpringFreq, rearSpringFreq);

            const engineWeightFactor = 0.02;
            const frontOptimalHeight = (frontMinHeight + frontMaxHeight) / 2 + (engineWeight + customEngineWeight) * engineWeightFactor;
            const rearOptimalHeight = (rearMinHeight + rearMaxHeight) / 2 - (engineWeight + customEngineWeight) * engineWeightFactor;

            const frontOptimalHeightNurburgring = Math.max(frontCurrentHeight * nurburgringFactor, frontMinHeight) + (engineWeight + customEngineWeight) * engineWeightFactor;
            const rearOptimalHeightNurburgring = Math.max(rearCurrentHeight * nurburgringFactor, rearMinHeight) - (engineWeight + customEngineWeight) * engineWeightFactor;

            const frontOptimalHeightTsukuba = Math.max(frontCurrentHeight * tsukubaFactor, frontMinHeight) + (engineWeight + customEngineWeight) * engineWeightFactor;
            const rearOptimalHeightTsukuba = Math.max(rearCurrentHeight * tsukubaFactor, rearMinHeight) - (engineWeight + customEngineWeight) * engineWeightFactor;

            document.getElementById("frontSpringRate").innerText = frontSpringRate.toFixed(2) + " N/mm";
            document.getElementById("rearSpringRate").innerText = rearSpringRate.toFixed(2) + " N/mm";

            document.getElementById("frontSpringFreqFromRate").innerText = frontSpringFreqFromRate.toFixed(2) + " Hz";
            document.getElementById("rearSpringFreqFromRate").innerText = rearSpringFreqFromRate.toFixed(2) + " Hz";

            document.getElementById("optimalFreqNurburgring").innerText = optimalFreqNurburgring.toFixed(2) + " Hz";

            document.getElementById("frontOptimalHeight").innerText = frontOptimalHeight.toFixed(2) + " mm";
            document.getElementById("rearOptimalHeight").innerText = rearOptimalHeight.toFixed(2) + " mm";

            document.getElementById("frontOptimalHeightNurburgring").innerText = frontOptimalHeightNurburgring.toFixed(2) + " mm";
            document.getElementById("rearOptimalHeightNurburgring").innerText = rearOptimalHeightNurburgring.toFixed(2) + " mm";

            document.getElementById("frontOptimalHeightTsukuba").innerText = frontOptimalHeightTsukuba.toFixed(2) + " mm";
            document.getElementById("rearOptimalHeightTsukuba").innerText = rearOptimalHeightTsukuba.toFixed(2) + " mm";
        }

        function getEngineWeight() {
            const engine = document.getElementById("engine").value;
            if (engine === "stock") {
                return 0;
            } else {
                return parseFloat(document.getElementById("customEngineWeight").value);
            }
        }

        function calculateOptimalFreqNurburgring(frontFreq, rearFreq) {
            return (frontFreq + rearFreq) / 2;
        }
    </script>
</head>
<body>
    <div class="form-container">
        <h1>レーシングサスペンション計算</h1>
        <label for="totalWeight">車両重量 (kg):</label>
        <input type="number" id="totalWeight" step="0.01" value="1000">
        <label for="weightRatio">重量配分 (%前):</label>
        <input type="number" id="weightRatio" step="0.01" value="50">
        <label for="engine">エンジン:</label>
        <select id="engine" onchange="calculateSuspension()">
            <option value="stock">ストック</option>
            <option value="custom">カスタム</option>
        </select>
        <label for="customEngineWeight">カスタムエンジン重量 (kg):</label>
        <input type="number" id="customEngineWeight" step="0.01" value="0">
        <label for="frontSpringFreq">フロント周波数 (Hz):</label>
        <input type="number" id="frontSpringFreq" step="0.01" value="2.5">
        <label for="rearSpringFreq">リア周波数 (Hz):</label>
        <input type="number" id="rearSpringFreq" step="0.01" value="2.5">
        <label for="frontCurrentHeight">フロント現在の高さ (mm):</label>
        <input type="number" id="frontCurrentHeight" step"0.01" value="100">
        <label for="rearCurrentHeight">リア現在の高さ (mm):</label>
        <input type="number" id="rearCurrentHeight" step="0.01" value="100">
        <label for="frontMinHeight">フロント最小高さ (mm):</label>
        <input type="number" id="frontMinHeight" step="0.01" value="80">
        <label for="frontMaxHeight">フロント最大高さ (mm):</label>
        <input type="number" id="frontMaxHeight" step="0.01" value="120">
        <label for="rearMinHeight">リア最小高さ (mm):</label>
        <input type="number" id="rearMinHeight" step="0.01" value="80">
        <label for="rearMaxHeight">リア最大高さ (mm):</label>
        <input type="number" id="rearMaxHeight" step="0.01" value="120">
        <button type="button" onclick="calculateSuspension()">計算</button>
        <h2>結果</h2>
        <p>フロントバネレート: <span id="frontSpringRate"></span></p>
        <p>リアバネレート: <span id="rearSpringRate"></span></p>
        <p>フロント周波数 (バネレートから): <span id="frontSpringFreqFromRate"></span></p>
        <p>リア周波数 (バネレートから): <span id="rearSpringFreqFromRate"></span></p>
        <p>最適周波数 (ニュルブルクリンク): <span id="optimalFreqNurburgring"></span></p>
        <p>最適フロント高さ: <span id="frontOptimalHeight"></span></p>
        <p>最適リア高さ: <span id="rearOptimalHeight"></span></p>
        <p>最適フロント高さ (ニュルブルクリンク): <span id="frontOptimalHeightNurburgring"></span></p>
        <p>最適リア高さ (ニュルブルクリンク): <span id="rearOptimalHeightNurburgring"></span></p>
        <p>最適フロント高さ (筑波サーキット): <span id="frontOptimalHeightTsukuba"></span></p>
        <p>最適リア高さ (筑波サーキット): <span id="rearOptimalHeightTsukuba"></span></p>
    </div>
</body>
</html>






